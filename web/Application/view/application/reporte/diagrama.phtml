<!-- BEGIN CONTENT-->
<div id="content">
    <section>
        <div class="section-header">
            <ol class="breadcrumb">
                 <?php echo \Application\Entity\Functions::getBreadCrumb($this->site, 'Grafico')?>
            </ol>
        </div><!--end .section-header -->
        <div class="section-body contain-lg">

            <div class="row">
               <div class="col-lg-12">
                   <div class="col-lg-6">
                        <!--<h2 class="text-primary">Área charts - Gráficos</h2>-->
                        <!--<h4>Horas x Cliente - <?php echo $this->nombre?></h4>-->
                   </div>
                   <div class="col-lg-6">
                       <div class="btn-group btn-group-sm pull-right">
                            <button type="button" class="btn btn-default-light dropdown-toggle" data-toggle="dropdown">
                                    <span class="glyphicon glyphicon-arrow-down"></span> Tipo Gráfico
                            </button>
                            <ul class="dropdown-menu dropdown-menu-right animation-dock" role="menu">
                                <li class="<?php echo ($tipo == \Application\Entity\Functions::GRAFICO_CIRCULAR) ? 'active' : ''?>">
                                    <a href="/application/reporte/diagrama?<?php echo \Auth\Entity\AuthPersonal::getUrlReportePersonal($this->codigo,\Application\Entity\Functions::GRAFICO_CIRCULAR)?>&site=<?php echo \Application\Entity\Functions::SITE_PERSONAL?>">
                                        Circular
                                    </a>
                                </li>
                                 <li class="<?php echo ($tipo == \Application\Entity\Functions::GRAFICO_BARRAS) ? 'active' : ''?>">
                                    <a href="/application/reporte/diagrama?<?php echo \Auth\Entity\AuthPersonal::getUrlReportePersonal($this->codigo,\Application\Entity\Functions::GRAFICO_BARRAS)?>&site=<?php echo \Application\Entity\Functions::SITE_PERSONAL?>">
                                        Barras
                                    </a>
                                </li>
                            </ul>
                        </div>
                   </div>
                </div>
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <?php if(!empty($this->data)) { ?>
                                <?php if($this->tipo == \Application\Entity\Functions::GRAFICO_BARRAS) { ?>                                    
                                    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                                <?php }elseif($this->tipo == \Application\Entity\Functions::GRAFICO_CIRCULAR) { ?>
                                    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                                    
                                <?php } ?>
                            <?php } else{ ?>
                                <p>No hay información para mostrar</p>
                            <?php } ?>                                
                        </div><!--end .card-body -->
                    </div><!--end .card -->
                    <!--<em class="text-caption">Grouped bar chart</em>-->
                </div><!--end .col -->
            </div><!--end .row -->


        </div><!--end .section-body -->
    </section>


</div><!--end #content-->
<!-- END CONTENT GRAFICOS DITER-->
<?php if(!empty($this->data)) { ?>
    <!--Grafico Diter-->
    <script src="<?php echo $this->server('static', 'assets/js/highcharts/js/highcharts.js', true)?>"></script>
    <script src="<?php echo $this->server('static', 'assets/js/highcharts/js/modules/exporting.js', true)?>"></script>    
    <script src="<?php echo $this->server('static', 'assets/js/highcharts/js/modules/data.js', true)?>"></script>
    <script src="<?php echo $this->server('static', 'assets/js/highcharts/js/modules/drilldown.js', true)?>"></script>
   

    <!--Fin Grafico Diter / Circular-->    
    <?php if($this->tipo == \Application\Entity\Functions::GRAFICO_BARRAS) { ?>
        <script type="text/javascript">
            $(function () {
                // Create the chart
                $('#container').highcharts({
                    chart: {
                        type: 'column'
                    },
                    
                    title: {
                        <?php foreach ($this->data as $value) { 
                                $areades = $value['areades'];
                         } ?>
                        text: 'Área - <?php echo $areades?>'
                    },
                    subtitle: {
                        text: '<?php echo $this->nombre?>'
                    },        
                    xAxis: {
                        type: 'category'
                    },
                    yAxis: {
                        title: {
                            text: 'Total porcentaje en Tiempo'
                        }

                    },
                    legend: {
                        enabled: false
                    },
                    plotOptions: {
                        series: {
                            borderWidth: 0,
                            dataLabels: {
                                enabled: true,
                                format: '{point.y}'
                            }
                        }
                    },

                    tooltip: {
                        headerFormat: '',//'<span style="font-size:11px">{series.name} </span><br>',
                        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y} Horas</b> <br/>'
                    },

                    series: [{
                        name: "Cliente",
                        colorByPoint: true,
                        data: [            
                        <?php foreach ($this->data as $value) { ?>
                            {name: "<?php echo $value['cliente'];?>", y: <?php echo $value['tiempo'];?>,drilldown: "<?php echo $value['cliente'];?>"},                         
                        <?php } ?>
                        ]
                    }],
                    drilldown: {
                        series: [
                        <?php foreach ($this->data as $value) { ?>
                        {name: "<?php echo $value['cliente'];?>",id: "<?php echo $value['cliente'];?>",
                            data: [
                                ["v11.0",24.13],
                                ["v8.0",17.2],
                                ["v9.0",8.11],
                                ["v10.0",5.33],
                                ["v6.0",1.06],
                                ["v7.0",0.5]
                            ]
                        },  
                        <?php } ?>
                        ]
                    }
                });
            });
	</script>
    <?php }elseif($this->tipo == \Application\Entity\Functions::GRAFICO_CIRCULAR) { ?>
        <script type="text/javascript">
            $(function () {
                $('#container').highcharts({
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                    },
                    title: {
                        <?php foreach ($this->data as $value) { 
                                $areades = $value['areades'];
                         } ?>
                        text: 'Área <?php echo $areades?>'
                    },
                    subtitle: {                        
                        text: '<?php echo $this->nombre?>'
                    },
                            
                    tooltip: {
                        //pointFormat: '{series.name}: <b>{point.y} Horas</b>'
                        pointFormat: '<b>{point.y} Horas ({point.percentage:.1f}%)</b>'
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.name} </b> {point.y}',
                                style: {
                                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                                }
                            },
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: "Cliente",
                        colorByPoint: true,
                        data: [                
                                <?php foreach ($this->data as $value) { ?>
                                    {name: "<?php echo $value['cliente'];?>", y: <?php echo $value['tiempo'];?>},                         
                                <?php } ?>
                              ]
                    }]
                });
            });
        </script>
        
    <?php } ?>
<?php } ?>
